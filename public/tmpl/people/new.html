<!DOCTYPE html>

<html>
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE-edge">
		<title>New Client</title>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Open+Sans">
		<link rel="stylesheet" href="/css/bootstrap.css">
		<link rel="stylesheet" href="/css/bootstrap-modal.css">
		<link rel="stylesheet" href="/css/font-awesome.css">
		<link rel="stylesheet" href="/css/select2.css">
		<link rel="stylesheet" href="/css/followup.css">
	</head>
	<body>
		<nav class="navbar navbar-default navbar-fixed-top">
			<div class="navbar-header">			
				<a class="navbar-brand" href="/"><i class="icon-beaker"></i> Followups</a>
			</div>			
		</nav>		
		
		<form method="post" action="/people" class="form-horizontal" style="margin-top: 50px;">
			<nav class="navbar navbar-default navbar-fixed-top" style="top: 50px; padding: 15px; border-top: solid 1px #ddd; z-index: 1;">
				<div class="btn-toolbar">
					<div class="btn-group col-xs-7 col-sm-3">
						<button type="submit" class="btn btn-primary">
							<i class="icon-save"></i>
							Save
						</button>
						<a href="/" class="btn btn-default">
							<i class="icon-undo"></i>
							Cancel
						</a>
					</div>
					<h3 style="display: inline-block; margin: auto; padding: 0;" class="col-xs-5 col-sm-9">New Client</h3>
				</div>
			</nav>	
			<input type="hidden" name="type" value="person" />

			<div class="form-group">
				<label class="control-label col-xs-12 col-sm-3 col-md-1">Name:</label>
				<input type="text" name="firstName" placeholder="First Name" class="form-control col-xs-12 col-sm-3 col-md-2" />
				<input type="text" name="lastName" placeholder="Last Name" class="form-control col-xs-12 col-sm-3 col-md-2" />
			</div>

			<div class="form-group">
				<label class="control-label col-xs-12 col-sm-3 col-md-1">Company:</label>
				<input type="text" name="organization" placeholder="Company" class="form-control col-xs-12 col-sm-3 col-md-2" />
			</div>

			<div class="form-group">
				<label class="control-label col-xs-12 col-sm-3 col-md-1">Address:</label>
				<input type="text" name="address[street]" placeholder="Street Address" class="form-control col-xs-12 col-sm-4 col-md-3" />
				<input type="text" name="address[city]" placeholder="City" class="form-control col-xs-12 col-sm-2 col-md-2" />
				<input type="hidden" name="address[province]" value="ON" />
			</div>

			<div class="form-group">
				<label class="control-label col-xs-12 col-sm-3 col-md-1">Phone:</label>
				<input type="hidden" name="phones[0][type]" value="Phone" />
				<input type="phone" name="phones[0][number]" placeholder="Phone" class="form-control col-xs-12 col-sm-3 col-md-2" />
				<div class="clearfix"></div>

				<label class="control-label col-xs-12 col-sm-3 col-md-1">Cell:</label>
				<input type="hidden" name="phones[1][type]" value="Cell" />
				<input type="phone" name="phones[1][number]" placeholder="Cell" class="form-control col-xs-12 col-sm-3 col-md-2" />
				<div class="clearfix"></div>

				<label class="control-label col-xs-12 col-sm-3 col-md-1">Email:</label>
				<input type="phone" name="email" placeholder="Email" class="form-control col-xs-12 col-sm-3 col-md-2" />
				<div class="clearfix"></div>
			</div>

			<div class="form-group">
				<label class="control-label col-xs-12 col-sm-3 col-md-1">Tags:</label>
				<input type="hidden" name="tags" class="col-xs-12 col-sm-6 col-md-4" data-placeholder="Tags" />
				<div class="clearfix"></div>
			</div>

			<div class="form-group nextContact">
				<input type="hidden" name="nextContact[type]" value="schedule" />
				<input type="hidden" name="nextContact[date]" />
				<label class="control-label col-xs-12 col-sm-3 col-md-1">&nbsp;</label>
				<div class="checkbox">
					<label>
						<input type="checkbox" checked> Create Followup
					</label>
				</div>
				<label class="control-label col-xs-12 col-sm-3 col-md-1">Each:</label>
				<select name="interval" class="form-control col-xs-12 col-sm-6 col-md-4">
					<option value="">Never</option>
					<option value="w">Week</option>
					<option value="m">Month</option>
					<option value="q" selected>Quarter</option>
					<option value="y">Year</option>
				</select>
				<div class="clearfix"></div>

				<label class="control-label col-xs-12 col-sm-3 col-md-1">&nbsp;</label>
				<span class="help-block col-xs-12 col-sm-6 col-md-4"></span>
				<div class="clearfix"></div>

				<label class="control-label col-xs-12 col-sm-3 col-md-1">Reason:</label>
				<input type="text" name="nextContact[reason]" placeholder="Reason" class="form-control col-xs-12 col-sm-6 col-md-4" />
			</div>
		</form>
		<script src="/js/jquery-1.10.2.js"></script>
		<script src="/js/bootstrap.js"></script>
		<script src="/js/moment.js"></script>
		<script src="/js/select2.js"></script>
		<script>
			$(function() {
				$('.nextContact input[type=checkbox]').on('click', function(e) {
					var disabled = !e.currentTarget.checked;
					$('.nextContact input,.nextContact select').prop('disabled', disabled);
					e.currentTarget.disabled = false;
				});

				$('select[name="nextContact[interval]"]').on('change', function(e) {
					var interval = $(e.currentTarget).val(),
						date = moment(),
						isoDate = '',
						dateDisplay = 'Don\'t follow up';
					switch(interval) {
						case 'w':
							date.add('w', 1);
							break;
						case 'm':
							date.add('M', 1);
							break;
						case 'q':
							date.add('M', 3);
							break;
						case 'y':
							date.add('y', 1);
							break;
						default:
							date = null;
					}

					if(date) {
						var format = date.year() == new Date().getFullYear() ? 'MMM D' : 'MMM D, YYYY';
						dateDisplay = 'Next contact scheduled for ' + date.format(format);
						isoDate = date.format();
					}

					$('.nextContact .help-block').html(dateDisplay);
					$('.nextContact input[name="nextContact[date]"]').val(isoDate);
				}).change();

				$('input[name=tags]').select2({
					tags: [<%= tags %>]
				})
			});
		</script>
	</body>
</html>